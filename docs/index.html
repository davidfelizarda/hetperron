<!DOCTYPE html>
<html lang="nl">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Het Perron â€” Narrowcasting</title>

<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Albert+Sans:wght@400;600;700;800;900&display=swap" rel="stylesheet">

<style>

:root{
  --brand-blue:#1242A8;
  --bg:#ffffff;
  --pad:48px;
}

*{ box-sizing:border-box; }

body{
  margin:0;
  font-family:"Albert Sans",system-ui,sans-serif;
  background:#111;
  overflow:hidden;
}

.stage{
  width:1080px;
  height:1920px;
  background:var(--bg);
  position:absolute;
  left:50%;
  top:50%;
  transform:translate(-50%,-50%) scale(var(--scale,1));
  transform-origin:center;
  overflow:hidden;
}

.screen{
  width:100%;
  height:100%;
  padding:var(--pad);
  display:none;
}
.screen.active{ display:block; }

/* ================= PROMO ================= */

#screen-promo{
  padding:0 !important;
  background:#000;
  position:relative;
}

#promoImg{
  position:absolute;
  inset:0;
  width:100%;
  height:100%;
  object-fit:cover;
  display:block;
}

</style>
</head>

<body>

<div class="stage" id="stage">

<!-- ================= ZAALPLANNING ================= -->
<section class="screen active" id="screen-planning">
  <!-- jouw bestaande planning HTML -->
</section>

<!-- ================= AGENDA ================= -->
<section class="screen" id="screen-agenda">
  <!-- jouw bestaande agenda HTML -->
</section>

<!-- ================= PROMO ================= -->
<section class="screen" id="screen-promo">
  <img id="promoImg" alt="">
</section>

</div>

<script>

/***********************
 * SCALE TO FIT
 ***********************/
function setScaleToFit() {
  const stage = document.getElementById("stage");
  const w = 1080, h = 1920;

  if (window.innerWidth >= w && window.innerHeight >= h) {
    stage.style.setProperty("--scale", "1");
    return;
  }

  const scale = Math.min(window.innerWidth / w, window.innerHeight / h);
  stage.style.setProperty("--scale", String(scale));
}

window.addEventListener("resize", setScaleToFit);
setScaleToFit();

/***********************
 * MAIN SCREEN ROTATION
 ***********************/
const screens = ["screen-planning","screen-agenda","screen-promo"];
const MAINSCREEN_MS = 20000;

let screenIndex = 0;

function setActiveScreen(id){
  screens.forEach(s =>
    document.getElementById(s).classList.toggle("active", s === id)
  );

  if(id==="screen-promo") startPromoSlideshow();
  else stopPromoSlideshow();
}

function startMainRotation(){
  setActiveScreen(screens[0]);

  setInterval(()=>{
    screenIndex = (screenIndex+1) % screens.length;
    setActiveScreen(screens[screenIndex]);
  }, MAINSCREEN_MS);
}

/***********************
 * PROMO SLIDESHOW
 ***********************/
const PROMO_SLIDE_MS = 10000;

let promoSlides = [];
let promoIndex = 0;
let promoTimer = null;
let promoRunning = false;

async function loadPromoSlides(){
  try{
    const res = await fetch(`promo/promo.json?ts=${Date.now()}`,{cache:"no-store"});
    if(!res.ok) return [];
    const list = await res.json();
    return Array.isArray(list) ? list : [];
  }catch(e){
    console.error(e);
    return [];
  }
}

function stopPromoSlideshow(){
  promoRunning=false;
  if(promoTimer){
    clearTimeout(promoTimer);
    promoTimer=null;
  }
}

async function startPromoSlideshow(){
  if(promoRunning) return;
  promoRunning=true;

  promoSlides = await loadPromoSlides();
  if(!promoSlides.length) return;

  const img=document.getElementById("promoImg");

  function step(){
    if(!promoRunning) return;

    img.src = `${promoSlides[promoIndex]}?ts=${Date.now()}`;
    promoIndex = (promoIndex+1)%promoSlides.length;

    promoTimer=setTimeout(step,PROMO_SLIDE_MS);
  }

  step();
}

/***********************
 * INIT
 ***********************/
startMainRotation();

</script>
</body>
</html>
